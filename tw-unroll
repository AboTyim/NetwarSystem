import httplib
import urlparse

def unroll(url):
	parsed = urlparse.urlparse(url)
	h = httplib.HTTPConnection(parsed.netloc)
	resource = parsed.path
	if parsed.query != "":
		resource += "?" + parsed.query
	h.request('HEAD', resource )
	response = h.getresponse()
	if response.status/100 == 3 and response.getheader('Location'):
		return unroll(response.getheader('Location')) 
	else:
		return url


url = "https://t.co/qPMImvOqF4"
print "Rolled: "+url
print "Unrolling..."
unrolled = unroll(url)
print "Unrolled: "+unrolled